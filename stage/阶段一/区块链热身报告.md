# åŒºå—é“¾çƒ­èº«æŠ¥å‘Š

16340296  å¼ å­æƒ

## ä»¥å¤ªåŠçš„å®‰è£…ã€ç§æœ‰é“¾åˆ›ä¸–åŒºå—æ­å»ºã€ç§æœ‰é“¾èŠ‚ç‚¹çš„åŠ å…¥(é€‰åš)

1. å®‰è£…ä»¥å¤ªåŠ
  ä»[http://ethereum.github.io/go-ethereum/downloads/](http://ethereum.github.io/go-ethereum/downloads/) ä¸‹è½½å®‰è£…Gethï¼Œå¯èƒ½éœ€è¦åœ¨windowsä¸‹æ·»åŠ ç¯å¢ƒå˜é‡ã€‚
  ![å®‰è£…ä»¥å¤ªåŠ](http://ziquanzhang-image.oss-cn-shenzhen.aliyuncs.com/Block-chain/%E9%98%B6%E6%AE%B51.%E7%83%AD%E8%BA%AB%E6%8A%A5%E5%91%8A/%E5%AE%89%E8%A3%85%E4%BB%A5%E5%A4%AA%E5%9D%8A.png)

2. ç§æœ‰é“¾åˆ›ä¸–åŒºå—æ­å»º
    æ–°å»ºä¸€ä¸ªgenesis.jsonï¼Œè®¾ç½®åˆ›ä¸–åŒºå—çš„éš¾åº¦,idç­‰å‚æ•°ã€‚æ–°å»ºæ–‡ä»¶å¤¹dataã€‚
    åˆå§‹åŒ–åˆ›ä¸–åŒºå—ï¼š
    ```css
    geth --datadir data/ init genesis.json
    ```
    å¯åŠ¨èŠ‚ç‚¹å¹¶è¿›å…¥äº¤äº’å¼æ§åˆ¶å°ï¼š
    ```css
    geth --datadir data --networkid 1008 --ipcdisable --port 1001 --rpcport 8001 --verbosity=4 console 2>>output.log
    ```
3. ç§æœ‰é“¾èŠ‚ç‚¹çš„åŠ å…¥
    å†æ–°å»ºä¸€ä¸ªèŠ‚ç‚¹ä¸ºdata0ã€‚
    å¯åŠ¨èŠ‚ç‚¹å¹¶è¿›å…¥äº¤äº’å¼æ§åˆ¶å°ï¼š
    ```css
    geth --datadir data0 --networkid 1008 --ipcdisable --port 1003 --rpcport 80222  console
    ```

    åœ¨ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ä¸­ä½¿ç”¨`admin.nodeInfo.enode`è·å–enodeã€‚
    åœ¨ç¬¬äºŒä¸ªèŠ‚ç‚¹ä¸­æ·»åŠ ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ã€‚
    ```css
    admin.addPeer("enode://e9e7ad186217fbf7b7d7185695dcd17afa73d23e1a1365dd96d01327aee87b2b95af8ca3857ce6b1f6a7d26c58abc19f5e0846787a1d35e21cab7c5fea0cee2a@[::]:1001")
    ```

    å†ä½¿ç”¨admin.peerså¯å¾—åˆ°åŠ å…¥èŠ‚ç‚¹çš„ä¿¡æ¯ã€‚
    ```json
    [{
        caps: ["eth/62", "eth/63"],
        enode: "enode://e9e7ad186217fbf7b7d7185695dcd17afa73d23e1a1365dd96d01327aee87b2b95af8ca3857ce6b1f6a7d26c58abc19f5e0846787a1d35e21cab7c5fea0cee2a@[::]:1001",
        id: "e4a6cb32cfb6b641dd2606bdb67571f63ff80ff1fe4883c1aa46cd5b89e110eb",
        name: "Geth/v1.8.17-stable-8bbe7207/windows-amd64/go1.11.1",
        network: {
        inbound: false,
        localAddress: "127.0.0.1:18752",
        remoteAddress: "127.0.0.1:1001",
        static: true,
        trusted: false
        },
        protocols: {
        eth: {
            difficulty: 85380105,
            head: "0xd2c073c35fb027d8dd8fe4d95174bc82ca93d96599dfb05e8deee320631621f0",
            version: 63
        }
        }
    }]
    ```

## å¯¹ getBlock ä¸­æ‰€å¾—åŒºå—çš„å„ä¸ªå­—æ®µè¿›è¡Œè§£é‡Š

  | å­—æ®µ  | ç±»å‹  | æ„ä¹‰ |
  |:--|:--|---|
  |difficulty       | BigNumber |è¡¨ç¤ºå½“å‰åŒºå—çš„éš¾åº¦ï¼Œæ ¹æ®å‰ä¸€ä¸ªåŒºå—çš„éš¾åº¦å’Œæ—¶é—´æˆ³è®¡ç®—å¾—åˆ°ï¼Œå¯çŸ¥å½“å‰åŒºå—1éš¾åº¦ä¸º131072|
  | extraData       | String |æŒ‡çš„æ˜¯é™„åŠ ä¿¡æ¯ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦å¡«å†™ä¿¡æ¯ã€‚32å­—èŠ‚ä»¥å†…çš„å­—èŠ‚æ•°ç»„ã€‚|
  | gasLimit        | Number |è¡¨ç¤ºå½“å‰åŒºå—å…è®¸ä½¿ç”¨çš„æœ€å¤§gasï¼ŒæŒ‡è¿™ç¬”äº¤æ˜“æœ€å¤šåªèƒ½ç»™çŸ¿å·¥è¿™ä¹ˆå¤šgasï¼Œè‹¥ç”¨ä¸å®Œåˆ™è¿”å›å¤šå‡ºçš„gasè¿”å›ï¼Œä½†å¦‚æœgaslimitä¸è¶³ä»¥æ”¯ä»˜äº¤æ˜“ï¼Œé‚£ä¹ˆä¸ä¼šé€€å›ï¼Œå› ä¸ºä»¥å¤ªåŠè§„å®šæ¯ç¬”äº¤æ˜“gasæœ€å°‘ä¸º21000ï¼Œæ‰€ä»¥ä¸€å®šè¦å¤§äº21000ã€‚åŒç†è‹¥åˆçº¦çš„gaslimitå°äºåŒºå—çš„gaslimitåˆ™éƒ¨ç½²ä¸äº†ã€‚|
  | gasUsed         | Number |å’ŒgasLimitç›¸å¯¹ï¼Œä¸ºå½“å‰åŒºå—æ‰€ç´¯ç§¯ä½¿ç”¨çš„gaså€¼ã€‚
  | hash            | String |æŒ‡è¯¥åŒºå—çš„å“ˆå¸Œå€¼ï¼Œå½“åŒºå—ç­‰å¾…è¢«åŒºå—é“¾ç¡®è®¤æ—¶ï¼Œåˆ™ä¸ºnullï¼Œå¯ä»¥è®¤ä¸ºæ˜¯åŒºå—åœ¨æ•´ä¸ªåŒºå—é“¾çš„ç´¢å¼•ã€‚|
  | logsBloom       | String |æ—¥å¿—Bloomè¿‡æ»¤å™¨ï¼Œä¿¡æ¯åŒ…å«åœ¨æ¯ä¸ªæ—¥å¿—å…¥å£, æ¥è‡ªäº¤æ˜“åˆ—è¡¨ä¸­æ¯ä¸ªäº¤æ˜“çš„æ¥å—è€…ã€‚|
  | miner           | String |è¡¨ç¤ºæ‰“åŒ…è¿™ä¸€åŒºå—çš„çŸ¿å·¥çš„åœ°å€ã€‚
  | mixHash         | String |æ··åˆå“ˆå¸Œï¼Œä¸nonceè¿›è¡Œå“ˆå¸Œè¿ç®—ï¼Œè¯æ˜å·²ç»ä»˜å‡ºäº†è¶³å¤Ÿçš„å·¥ä½œé‡ã€‚|
  | nonce           | String |ä¸€ä¸ªéšæœºæ•°64ä½å“ˆå¸Œï¼Œè¡¨ç¤ºè¯¥çŸ¿å·¥æ‰¾åˆ°çš„ç¬¦åˆæ¡ä»¶çš„nonceå€¼ã€‚|
  | number          | Number  |ä¸ºåŒºå—ç¼–å·ï¼ŒæŒ‡è¯¥åŒºå—ä¸ºç¬¬å‡ ä¸ªåŒºå—ã€‚|
  | parentHash      | String |çˆ¶å“ˆå¸Œï¼ŒæŒ‡ä¸Šä¸€ä¸ªåŒºå—çš„å“ˆå¸Œå€¼ã€‚å› ä¸ºåˆ›ä¸–åŒºå—æ²¡çˆ¶åŒºå—ï¼Œæ‰€ä»¥è¿™ä¸ªå€¼ä¸º0ã€‚|
  | receiptsRoot    | String |äº¤æ˜“å®Œæˆåï¼Œç”±äº¤æ˜“æ”¶æ®ï¼Œæ—¥å¿—å†…å®¹æ„æˆçš„æ•°æ®çš„å­—å…¸æ ‘æ ¹èŠ‚ç‚¹å“ˆå¸Œã€‚|
  | sha3Uncles      | String |ç±»ä¼¼ä¸Šä¸€ä¸ªï¼ŒæŒ‡ç”±å”åŒºå—å“ˆå¸Œæ„æˆçš„å­—å…¸æ ‘çš„æ ¹èŠ‚ç‚¹å“ˆå¸Œã€‚|
  | size            | Number  |å½“å‰è¿™ä¸ªåŒºå—çš„å­—èŠ‚å¤§å°ã€‚|
  | stateRoot       | String |çŠ¶æ€å­—å…¸æ ‘æ ¹èŠ‚ç‚¹çš„å“ˆå¸Œã€‚|
  | timestamp       | Number  |æŒ‡å½“å‰è¯¥åŒºå—åˆå§‹åŒ–æ—¶çš„Unixæ—¶é—´æˆ³ã€‚|
  | totalDifficulty | Number  |åˆ°å½“å‰åŒºå—ä¸ºæ­¢ï¼Œæ‰€ç§¯ç´¯çš„æ‰€æœ‰åŒºå—éš¾åº¦ä¹‹å’Œã€‚|
  | transactions    | æ•°ç»„ |å½“å‰åŒºå—æ‰€åŒ…å«çš„äº¤æ˜“ã€‚|
  | transactionsRoot| String |åŒ…å«æ‰€æœ‰äº¤æ˜“çš„äº¤æ˜“å­—å…¸æ ‘çš„æ ¹èŠ‚ç‚¹å“ˆå¸Œå€¼ã€‚|
  | Uncles          | æ•°ç»„ |åŒ…å«å½“å‰åŒºå—çš„æ‰€ä»¥å”åŒºå—ã€‚|

## å¯¹æ—¥å¿—è¾“å‡ºè¿›è¡Œè§£é‡Š

* åˆå§‹åŒ–åŒºå—é“¾ï¼Œåˆ†é…æ–‡ä»¶å¤¹å’Œç©ºé—´ï¼Œå†™å…¥åˆ›ä¸–å—ï¼ŒæŒä¹…åŒ–å­—å…¸æ ‘ã€‚
    ```json
    INFO [11-04|15:30:01.915] Allocated cache and file handles         database="D:\\Program Files\\Geth\\data\\geth\\chaindata" cache=16 handles=16

    INFO [11-04|15:30:01.940] Writing custom genesis block

    INFO [11-04|15:30:01.941] Persisted trie from memory database      nodes=0 size=0.00B time=0s gcnodes=0 gcsize=0.00B gctime=0s livenodes=1 livesize=0.00B

    INFO [11-04|15:30:01.941] Successfully wrote genesis state         database=chaindata hash=5e1fc7â€¦790e0
    ```

* å¼€å§‹è¿æ¥æ—¶ï¼Œåˆå§‹åŒ–ä»¥å¤ªåŠåè®®ï¼Œè½½å…¥æœ€è¿‘çš„åŒºå—ï¼Œé‡æ–°åŠ è½½äº¤æ˜“å’Œç”Ÿæˆäº¤æ˜“æ—¥å¿—ã€‚
    ```json
    INFO [11-04|15:31:05.759] Initialising Ethereum protocol           versions="[63 62]" network=1008

    INFO [11-04|15:31:05.759] Loaded most recent local header          number=0 hash=5e1fc7â€¦790e0 td=131072 age=49y6mo2w

    INFO [11-04|15:31:05.760] Loaded most recent local full block      number=0 hash=5e1fc7â€¦790e0 td=131072 age=49y6mo2w
    INFO [11-04|15:31:05.760] Loaded most recent local fast block      number=0 hash=5e1fc7â€¦790e0 td=131072 age=49y6mo2w

    DEBUG[11-04|15:31:05.760] Reinjecting stale transactions           count=0

    INFO [11-04|15:31:05.762] Regenerated local transaction journal    transactions=0 accounts=0
    ```

* è¾“å…¥exitå…³é—­è¿æ¥ï¼Œä¹‹åå°†ç¼“å­˜ä¸­çš„çŠ¶æ€å†™å…¥ç£ç›˜æŒä¹…åŒ–æ•°æ®ï¼Œå…³é—­åŒºå—é“¾ï¼Œå…³é—­åè®®å’Œäº¤æ˜“æ± ï¼Œæœ€åå…³é—­æ•°æ®åº“ã€‚
    ```json
    INFO [11-04|17:11:41.533] Writing cached state to disk             block=454 hash=4713ecéˆ¥?7d4ca root=a006fféˆ¥î›‹e94ea

    INFO [11-04|17:11:41.533] Persisted trie from memory database      nodes=0 size=0.00B time=0s gcnodes=0 gcsize=0.00B gc
        time=0s livenodes=1 livesize=0.00B

    INFO [11-04|17:11:41.533] Blockchain manager stopped

    INFO [11-04|17:11:41.533] Stopping Ethereum protocol

    INFO [11-04|17:11:41.533] Ethereum protocol stopped

    INFO [11-04|17:11:41.533] Transaction pool stopped

    INFO [11-04|17:11:41.533] Database closed                          database="D:\\Program Files\\Geth\\data\\geth\\chain
    data"
    ```
* çŸ¿å·¥æŒ–çŸ¿ï¼Œæ‰“åŒ…æ–°åŒºå—ï¼Œå¼€é‡‡æ½œåœ¨çš„åŒºå—ã€‚
    ```json
    INFO [11-04|17:30:48.082] Commit new mining work                   number=593 sealhash=108a77â€¦bbb5d6 uncles=0 txs=0 gas=0 fees=0 elapsed=35.904ms
    INFO [11-04|17:30:49.212] Successfully sealed new block            number=593 sealhash=108a77â€¦bbb5d6 hash=c52790â€¦332920 elapsed=1.166s
    INFO [11-04|17:30:49.217] ğŸ”¨ mined potential block                  number=593 hash=c52790â€¦332920
    ```
* æäº¤äº¤æ˜“ã€‚
    ```json
    INFO [11-04|18:25:09.342] Setting new local account                address=0x15b97213fB8ee04D2ed53113E41035FEaE88461e
    INFO [11-04|18:25:09.346] Submitted transaction                    fullhash=0x889aa5bb7bc45463a5f59012b2ac15abdce71542a48bc6a6be91969c48eac6a5 recipient=0x6a949Cd94E739d035d13c2242B32093553567361
    "0x889aa5bb7bc45463a5f59012b2ac15abdce71542a48bc6a6be91969c48eac6a5"
    ```
* éšåé€šè¿‡æŒ–çŸ¿å‘ç°æœ‰ä¸€gas=420000çš„åŒºå—ã€‚
    ```json
    INFO [11-04|18:32:42.760] Commit new mining work                   number=607 sealhash=916deaâ€¦38331b uncles=0 txs=2 gas=42000 fees=4.2e-05 elapsed=8.943ms
    ```
* æ·»åŠ èŠ‚ç‚¹ã€‚
    ```json
    INFO [11-04|18:39:56.578] Block synchronisation started
    INFO [11-04|18:39:56.709] Imported new chain segment               blocks=26 txs=7 mgas=0.126 elapsed=111.730ms mgasps=1.128 number=607 hash=d2c073â€¦1621f0 age=7m14s   cache=17.84kB ignored=2
    ```

## ç¼–å†™ç®€å•çš„æ™ºèƒ½åˆçº¦ï¼Œåœ¨ remix ä¸‹è¿›è¡Œè°ƒè¯•ï¼Œå¹¶éƒ¨ç½²åœ¨é“¾ä¸Šè¿›è¡Œè°ƒç”¨

### ç¼–å†™ç®€å•çš„æ™ºèƒ½åˆçº¦

ç¼–å†™ä¸€ä¸ªç±»ä¼¼ä¸å¤è¯»æœºçš„ä¸œè¥¿ï¼Œå‘é€å­—ç¬¦ä¸²ä¿å­˜ï¼Œä¹‹åå¤è¯»å‘é€çš„è¯ã€‚

solidityä»£ç ï¼š

```java
contract AI {
    string box;

    function send(string s) public {
        box = s;
    }

    function clear() public{
        box = "";
    }

    function receive() public constant returns (string) {
        return box;
    }

    function greet() public constant returns (string) {
        return "hello";
    }
}
```

### è¿›è¡Œè°ƒè¯•éƒ¨ç½²è°ƒç”¨

1. éƒ¨ç½²åˆçº¦  
    ![éƒ¨ç½²åˆçº¦](http://ziquanzhang-image.oss-cn-shenzhen.aliyuncs.com/Block-chain/%E9%98%B6%E6%AE%B51.%E7%83%AD%E8%BA%AB%E6%8A%A5%E5%91%8A/%E9%83%A8%E7%BD%B2%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6.png)
    è¿›è¡ŒæŒ–çŸ¿åæˆåŠŸéƒ¨ç½²ã€‚

2. greet  
    ![greet](http://ziquanzhang-image.oss-cn-shenzhen.aliyuncs.com/Block-chain/%E9%98%B6%E6%AE%B51.%E7%83%AD%E8%BA%AB%E6%8A%A5%E5%91%8A/greet.png)

3. å‘é€ä¿¡æ¯ï¼Œäº§ç”Ÿäº¤æ˜“ï¼ŒæŒ–çŸ¿åäº¤æ˜“æˆåŠŸã€‚  
    ![send](http://ziquanzhang-image.oss-cn-shenzhen.aliyuncs.com/Block-chain/%E9%98%B6%E6%AE%B51.%E7%83%AD%E8%BA%AB%E6%8A%A5%E5%91%8A/%E5%8F%91%E9%80%81string.png)

4. äº¤æ˜“æˆåŠŸåæ›´æ–°é‡Œé¢çš„stringï¼Œå†ç”¨receiveå¾—åˆ°åˆšåˆšçš„æ¶ˆæ¯ã€‚  
    ![receive](http://ziquanzhang-image.oss-cn-shenzhen.aliyuncs.com/Block-chain/%E9%98%B6%E6%AE%B51.%E7%83%AD%E8%BA%AB%E6%8A%A5%E5%91%8A/receive.png)

5. æ¸…é™¤æ¶ˆæ¯ï¼Œä¹Ÿéœ€è¦äº§ç”Ÿäº¤æ˜“ï¼Œç„¶åæŒ–çŸ¿ä½¿äº¤æ˜“æˆåŠŸã€‚

## å¯¹äº¤æ˜“çš„å­—æ®µè¿›è¡Œè§£é‡Š

æ ¹æ®ä»¥ä¸Š3çš„å‘é€æ¶ˆæ¯çš„äº¤æ˜“è¿›è¡Œè§£é‡Šã€‚

```json
eth.getTransaction("0xeb7a55e1760ecc986f813c881b76ab12b812bc611f8f6b9cacb69248438b50ec")
{
    blockHash: "0x06258165d31d4ea7ed945fa430d8e25f75690c0ae20ca4d2ae8f6de40576d261",
    blockNumber: 642,
    from: "0x15b97213fb8ee04d2ed53113e41035feae88461e",
    gas: 43406,
    gasPrice: 1000000000,
    hash: "0xeb7a55e1760ecc986f813c881b76ab12b812bc611f8f6b9cacb69248438b50ec",
    input: "0x66792ba10000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000ce5bc80e5a78be5a48de8afbb0000000000000000000000000000000000000000",
    nonce: 14,
    r: "0x3892abe334fbe797ce57155373c9c36860121d143950f873e554dc37321847d",
    s: "0x55eea1e92c492bd89f7db381fda08ae795fdc7abdbcff4c98f897cae94edae7c",
    to: "0x2eb0f4a6c064c51033dbc5977973bcb6702a9cdd",
    transactionIndex: 0,
    v: "0x37",
    value: 0
}
```

| å­—æ®µåç§°  | ç±»å‹  | æ„ä¹‰ |
|:--|:--|---|
| blockHash | String  | äº¤æ˜“æ‰€å¤„åŒºå—çš„å“ˆå¸Œå€¼  |
| blockNumber | Number | å½“å‰äº¤æ˜“æ‰€å¤„åœ¨åŒºå—çš„ç¼–å· |
| from | String | å‘èµ·äº¤æ˜“çš„è´¦æˆ·ï¼ˆåœ°å€ï¼‰|
| gas | Number | å®Œæˆè¿™ç¬”äº¤æ˜“æ‰€éœ€è¦çš„gas |
| gasPrice | Number | å½“å‰æ¯ä¸ªgasæ‰€éœ€çš„èŠ±è´¹ |
| hash | String | å½“å‰äº¤æ˜“çš„å“ˆå¸Œå€¼ |
| input | String | éƒ¨ç½²æ™ºèƒ½åˆçº¦äº¤æ˜“çš„16è¿›åˆ¶ä»£ç ï¼Œåˆçº¦è°ƒç”¨ç›¸å…³çš„äºŒè¿›åˆ¶ä¿¡æ¯ |
| nonce | Number | ç›¸å½“äºå‘èµ·äººçš„äº¤æ˜“åºå·ï¼Œæ¯å‘é€ä¸€ç¬”äº¤æ˜“ï¼Œnonce+1ï¼Œæ”¾ç½®äº¤æ˜“é‡å¤è¿›è¡Œ |
| r | String | å‘èµ·äººEOAçš„ECDSAç­¾åçš„ä¸‰ä¸ªç»„æˆéƒ¨åˆ† |
| s | String | å‘èµ·äººEOAçš„ECDSAç­¾åçš„ä¸‰ä¸ªç»„æˆéƒ¨åˆ† |
| to | String | ç›®æ ‡ä»¥å¤ªåŠåœ°å€ |
| transactionIndex | Number | äº¤æ˜“ç´¢å¼• |
| v | String | å‘èµ·äººEOAçš„ECDSAç­¾åçš„ä¸‰ä¸ªç»„æˆéƒ¨åˆ† |
| values | Number | è¦å‘é€åˆ°ç›®çš„åœ°å€çš„ä»¥å¤ªå¸æ•° |